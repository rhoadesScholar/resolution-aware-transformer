# RAY Training Configuration Template
# This configuration works with run_ray_experiments.py, ray_train.py, and ray_evaluate.py

# Experiment identification
experiment_name: "rat_medical_segmentation"
task_type: "segmentation"  # or "detection"

# Model configuration
model:
  name: "rat"  # Resolution Aware Transformer
  multi_scale: true
  spatial_dims: 2  # 2D images (use 3 for volumes)
  feature_dims: 128  # Embedding dimension
  num_blocks: 4      # Transformer layers
  num_heads: 8       # Attention heads
  mlp_ratio: 4       # MLP expansion ratio
  attention_type: "dense"  # "dense", "sparse", or "mixed"
  positional_encoding: "rose"  # "rose", "rope", "absolute", or "none"
  input_features: 3  # RGB images

# Training configuration
training:
  # Optimizer settings
  learning_rate: 0.0001
  weight_decay: 0.01
  optimizer: "adamw"
  
  # Training schedule
  epochs: 100
  
  # Regularization
  grad_clip: 1.0  # Gradient clipping norm
  mixed_precision: true  # FP16 training
  
  # DeepSpeed settings (automatically configured)
  use_deepspeed: true  # Enable for multi-GPU training
  zero_stage: 2  # ZeRO optimization stage (2 or 3)

# Data configuration
data:
  dataset_name: "isic2018"  # or "coco2017"
  local_data_dir: "/tmp/datasets/"  # Local fast storage for datasets
  dataset_url: "auto"  # Automatic download
  
  # Data preprocessing
  image_size: 256  # Base resolution
  num_workers: 4   # Data loading workers
  pin_memory: true

# Evaluation configuration
evaluation:
  batch_size: 16  # Evaluation batch size
  robustness_test: false  # Enable for robustness evaluation
  test_resolutions: [128, 256, 512]  # Resolutions for robustness testing

# Results and logging
results:
  output_dir: "./results/medical_segmentation"  # Network storage for results

# Resource configuration
resources:
  num_gpus: 4  # Number of GPUs to use
  num_cpus_per_gpu: 4  # CPU cores per GPU

# Quick mode overrides (used with --quick flag)
quick_mode:
  epochs: 5
  batch_size: 4
  num_workers: 2
# Ray automatically handles distributed training - no manual configuration needed!
